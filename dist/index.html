<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chromecast Receiver</title>
  <script type="module" crossorigin>(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function c(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=c(i);fetch(i.href,o)}})();const v=2e3,P=500,Y=2,M=["#ff0000","#00ff00","#0000ff"],m=50,q=20,l=document.getElementById("canvas"),{Engine:z,Render:b,World:T,Bodies:w,Runner:L}=Matter,d=z.create({gravity:{x:0,y:1,scale:.001}});let y,G,N,D,S;function H(e,n){T.clear(d.world,!1),l.width=e,l.height=n,y&&(b.stop(y),y.canvas.remove()),y=b.create({canvas:l,engine:d,options:{width:e,height:n,wireframes:!1,background:"#000000"}}),G=w.rectangle(e/2,n+m/2,e,m,{isStatic:!0,render:{fillStyle:"#000000"}}),N=w.rectangle(-m/2,n/2,m,n*2,{isStatic:!0,render:{fillStyle:"#000000"}}),D=w.rectangle(e+m/2,n/2,m,n*2,{isStatic:!0,render:{fillStyle:"#000000"}}),T.add(d.world,[G,N,D]),b.run(y),S||(S=L.create(),L.run(S,d))}function F(){const e=window.innerWidth,n=window.innerHeight;H(e,n)}const t={circles:[],particles:[],selectedCircleIndex:-1,maxChain:0,highScore:0,isGameOver:!1,gameOverStartTime:0,isNewHighScore:!1,nextColorIndex:0,spawnInterval:P},{World:k}=Matter;function K(){if(t.isGameOver)return;document.body.classList.remove("danger-zone");const e=t.maxChain>t.highScore;e&&(t.highScore=t.maxChain),Object.assign(t,{isGameOver:!0,gameOverStartTime:Date.now(),isNewHighScore:e})}function B(){t.circles.forEach(e=>{k.remove(d.world,e.body)}),t.circles.length=0,t.particles.forEach(e=>{k.remove(d.world,e.body)}),t.particles.length=0,document.body.classList.remove("danger-zone"),Object.assign(t,{isGameOver:!1,selectedCircleIndex:-1,maxChain:0,isNewHighScore:!1,spawnInterval:P,nextColorIndex:0})}function W(e,n){if(t.circles.length===0){t.selectedCircleIndex=-1;return}let c=0,r=Number.MAX_VALUE;t.circles.forEach((i,o)=>{const s=i.body.position.x-e,a=i.body.position.y-n,f=Math.sqrt(s*s+a*a);f<r&&(r=f,c=o)}),t.selectedCircleIndex=c}function I(){const e=l.width/2,n=l.height/2;W(e,n)}function g(e){if(t.circles.length===0)return;if(t.selectedCircleIndex===-1){I();return}const n=t.circles[t.selectedCircleIndex];if(!n){I();return}const c=n.body.position;let r=0,i=0;switch(e){case"up":i=-1;break;case"down":i=1;break;case"left":r=-1;break;case"right":r=1;break}let o=-1,s=Number.MAX_VALUE;t.circles.forEach((a,f)=>{if(f===t.selectedCircleIndex)return;const h=a.body.position,x=h.x-c.x,u=h.y-c.y;let p=!1;switch(e){case"up":p=u<0;break;case"down":p=u>0;break;case"left":p=x<0;break;case"right":p=x>0;break}if(!p)return;const E=Math.sqrt(x*x+u*u),V=(x*r+u*i)/E,R=E*(2-V);R<s&&(s=R,o=f)}),o!==-1&&(t.selectedCircleIndex=o)}const{World:A,Bodies:_,Body:U}=Matter;function j(){const e=l.width,n=e*(.02+Math.random()*.03),c=n+Math.random()*(e-n*2),r=-n,i=M[t.nextColorIndex];t.nextColorIndex=(t.nextColorIndex+1)%M.length;const o=_.circle(c,r,n,{restitution:.6,friction:.1,render:{fillStyle:i}});A.add(d.world,o),t.circles.push({body:o,createdAt:Date.now(),initialRadius:n,currentRadius:n,color:i})}function Z(e,n){const c=e.body.position,r=n.body.position,i=r.x-c.x,o=r.y-c.y;return Math.sqrt(i*i+o*o)<=e.currentRadius+n.currentRadius+5}function X(e,n){let c;n===null?c=t.circles:n===void 0?c=t.circles.filter(o=>o.color===e.color):c=t.circles.filter(o=>o.color===n);const r=new Set([e]),i=[e];for(;i.length>0;){const o=i.pop();c.forEach(s=>{!r.has(s)&&Z(o,s)&&(r.add(s),i.push(s))})}return Array.from(r)}function J(e){return X(e,null)}function Q(){if(t.circles.length===0)return null;let e=null,n=-1/0;if(t.circles.forEach(a=>{a.body.position.y>n&&(n=a.body.position.y,e=a)}),!e||!(e.body.position.y+e.currentRadius>=l.height-10))return null;const i=J(e);if(i.length===0)return null;let o=1/0;return i.forEach(a=>{a.body.position.y<o&&(o=a.body.position.y)}),o/l.height*100}function C(e){const n={x:e.body.position.x,y:e.body.position.y},c=X(e);c.length>t.maxChain&&(t.maxChain=c.length),c.forEach(r=>{const i=r.body.position;for(let o=0;o<33;o++){const s=Math.PI*2*o/33,a=(5+Math.random()*10)/3,f=i.x+Math.cos(s)*r.currentRadius,h=i.y+Math.sin(s)*r.currentRadius,x=2,u=_.circle(f,h,x,{restitution:.3,friction:.05,render:{fillStyle:r.color}});U.setVelocity(u,{x:Math.cos(s)*a,y:Math.sin(s)*a}),A.add(d.world,u),t.particles.push({body:u,createdAt:Date.now(),initialRadius:x})}A.remove(d.world,r.body)}),c.forEach(r=>{const i=t.circles.indexOf(r);i>-1&&t.circles.splice(i,1)}),W(n.x,n.y)}function ee(){l.addEventListener("click",e=>{if(t.isGameOver){Date.now()-t.gameOverStartTime>=v&&B();return}const n=l.getBoundingClientRect(),c=e.clientX-n.left,r=e.clientY-n.top;for(let i=t.circles.length-1;i>=0;i--){const o=t.circles[i],s=o.body.position.x-c,a=o.body.position.y-r;if(Math.sqrt(s*s+a*a)<=o.currentRadius){C(o);break}}}),window.addEventListener("keydown",e=>{if(t.isGameOver){Date.now()-t.gameOverStartTime>=v&&(e.preventDefault(),B());return}switch(e.key){case"ArrowUp":e.preventDefault(),g("up");break;case"ArrowDown":e.preventDefault(),g("down");break;case"ArrowLeft":e.preventDefault(),g("left");break;case"ArrowRight":e.preventDefault(),g("right");break;case"Enter":e.preventDefault(),t.selectedCircleIndex>=0&&t.selectedCircleIndex<t.circles.length&&C(t.circles[t.selectedCircleIndex]);break;case" ":e.preventDefault(),t.selectedCircleIndex===-1?I():t.selectedCircleIndex>=0&&t.selectedCircleIndex<t.circles.length&&C(t.circles[t.selectedCircleIndex]);break}})}function te(){const e=y.context;e.save(),e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(0,0,l.width,l.height),e.textAlign="center",e.textBaseline="middle",t.isNewHighScore&&(e.font="bold 48px Arial",e.fillStyle="#FFD700",e.fillText("ðŸ‘‘ New high score!",l.width/2,l.height/2-150)),e.font="bold 96px Arial",e.fillStyle="#ffffff",e.fillText("GAME OVER",l.width/2,l.height/2-50),e.font="bold 40px Arial",e.fillStyle="#ffffff",e.fillText(`Max chain: ${t.maxChain}`,l.width/2,l.height/2+30),e.font="bold 32px Arial",e.fillStyle="#aaaaaa",e.fillText(`High score: ${t.highScore}`,l.width/2,l.height/2+80),Date.now()-t.gameOverStartTime>=v&&(e.font="bold 32px Arial",e.fillStyle="#ffffff",e.fillText("Click to restart",l.width/2,l.height/2+150)),e.textAlign="center";const c=l.width-200;e.font="bold 32px Arial",e.fillStyle="#ffffff",e.textBaseline="top",e.fillText("MAX",c,140),e.font="bold 32px Arial",e.fillStyle="#ffffff",e.fillText("CHAIN",c,180),e.font="bold 96px Arial",e.fillStyle="#ffffff",e.fillText(`${t.maxChain}`,c,220),e.restore()}function ne(){if(t.selectedCircleIndex>=0&&t.selectedCircleIndex<t.circles.length){const e=t.circles[t.selectedCircleIndex],n=y.context,c=e.body.position,r=e.currentRadius+15;n.beginPath(),n.arc(c.x,c.y,r,0,Math.PI*2),n.strokeStyle="#ffffff",n.lineWidth=5,n.stroke()}}function ie(){const e=y.context;e.save(),e.textAlign="center";const n=l.width-200;e.font="bold 32px Arial",e.fillStyle="#ffffff",e.textBaseline="top",e.fillText("MAX",n,140),e.font="bold 32px Arial",e.fillStyle="#ffffff",e.fillText("CHAIN",n,180),e.font="bold 96px Arial",e.fillStyle="#ffffff",e.fillText(`${t.maxChain}`,n,220),e.restore()}const{World:oe,Body:re}=Matter;function O(){const e=Date.now();if(t.isGameOver){te(),requestAnimationFrame(O);return}const n=Q();n!==null&&n<0&&K(),n!==null&&n<=q?document.body.classList.add("danger-zone"):document.body.classList.remove("danger-zone"),t.selectedCircleIndex>=t.circles.length&&(t.selectedCircleIndex=-1);const c=[];t.particles.forEach(r=>{const o=(e-r.createdAt)/1e3;if(o>=1)c.push(r);else{const s=1-o;r.body.render.opacity=s;const a=1-o*.9,h=r.initialRadius*a/(r.body.circleRadius||r.initialRadius);h>.01&&re.scale(r.body,h,h)}}),c.forEach(r=>{oe.remove(d.world,r.body);const i=t.particles.indexOf(r);i>-1&&t.particles.splice(i,1)}),ne(),ie(),requestAnimationFrame(O)}function $(){setTimeout(()=>{t.isGameOver||(j(),t.spawnInterval=Math.max(50,t.spawnInterval-Y)),$()},t.spawnInterval)}H(window.innerWidth,window.innerHeight);window.addEventListener("resize",F);ee();O();$();</script>
  <style rel="stylesheet" crossorigin>*{margin:0;padding:0;box-sizing:border-box}body{width:100vw;height:100vh;background-color:#000;overflow:hidden;position:relative}body.danger-zone{animation:pulseRed 2s ease-in-out infinite}@keyframes pulseRed{0%{background-color:#000}50%{background-color:red}to{background-color:#000}}#canvas{display:block;width:100%;height:100%}</style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <script src="https://cdn.jsdelivr.net/npm/matter-js@0.19.0/build/matter.min.js"></script>
</body>
</html>
