<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chromecast Receiver</title>
  <script type="module" crossorigin>(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function c(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=c(r);fetch(r.href,i)}})();const v=2e3,H=500,Y=2,M=["#ff0000","#00ff00","#0000ff"],m=50,q=20,l=document.getElementById("canvas"),{Engine:z,Render:b,World:T,Bodies:w,Runner:L}=Matter,d=z.create({gravity:{x:0,y:1,scale:.001}});let y,N,D,G,S;function B(e,n){T.clear(d.world,!1),l.width=e,l.height=n,y&&(b.stop(y),y.canvas.remove()),y=b.create({canvas:l,engine:d,options:{width:e,height:n,wireframes:!1,background:"#000000"}}),N=w.rectangle(e/2,n+m/2,e,m,{isStatic:!0,render:{fillStyle:"#000000"}}),D=w.rectangle(-m/2,n/2,m,n*2,{isStatic:!0,render:{fillStyle:"#000000"}}),G=w.rectangle(e+m/2,n/2,m,n*2,{isStatic:!0,render:{fillStyle:"#000000"}}),T.add(d.world,[N,D,G]),b.run(y),S||(S=L.create(),L.run(S,d))}function F(){const e=window.innerWidth,n=window.innerHeight;B(e,n)}const t={circles:[],particles:[],selectedCircleIndex:-1,maxChain:0,highScore:0,isGameOver:!1,gameOverStartTime:0,isNewHighScore:!1,nextColorIndex:0,spawnInterval:H},{World:k}=Matter;function K(){if(t.isGameOver)return;document.body.classList.remove("danger-zone");const e=t.maxChain>t.highScore;e&&(t.highScore=t.maxChain),Object.assign(t,{isGameOver:!0,gameOverStartTime:Date.now(),isNewHighScore:e})}function P(){t.circles.forEach(e=>{k.remove(d.world,e.body)}),t.circles.length=0,t.particles.forEach(e=>{k.remove(d.world,e.body)}),t.particles.length=0,document.body.classList.remove("danger-zone"),Object.assign(t,{isGameOver:!1,selectedCircleIndex:-1,maxChain:0,isNewHighScore:!1,spawnInterval:H,nextColorIndex:0})}function W(e,n){if(t.circles.length===0){t.selectedCircleIndex=-1;return}let c=0,o=Number.MAX_VALUE;t.circles.forEach((r,i)=>{const s=r.body.position.x-e,a=r.body.position.y-n,f=Math.sqrt(s*s+a*a);f<o&&(o=f,c=i)}),t.selectedCircleIndex=c}function I(){const e=l.width/2,n=l.height/2;W(e,n)}function g(e){if(t.circles.length===0)return;if(t.selectedCircleIndex===-1){I();return}const n=t.circles[t.selectedCircleIndex];if(!n){I();return}const c=n.body.position;let o=0,r=0;switch(e){case"up":r=-1;break;case"down":r=1;break;case"left":o=-1;break;case"right":o=1;break}let i=-1,s=Number.MAX_VALUE;t.circles.forEach((a,f)=>{if(f===t.selectedCircleIndex)return;const h=a.body.position,x=h.x-c.x,u=h.y-c.y;let p=!1;switch(e){case"up":p=u<0;break;case"down":p=u>0;break;case"left":p=x<0;break;case"right":p=x>0;break}if(!p)return;const E=Math.sqrt(x*x+u*u),V=(x*o+u*r)/E,R=E*(2-V);R<s&&(s=R,i=f)}),i!==-1&&(t.selectedCircleIndex=i)}const{World:A,Bodies:_,Body:U}=Matter;function j(){const e=l.width,n=e*(.02+Math.random()*.03),c=n+Math.random()*(e-n*2),o=-n,r=M[t.nextColorIndex];t.nextColorIndex=(t.nextColorIndex+1)%M.length;const i=_.circle(c,o,n,{restitution:.6,friction:.1,render:{fillStyle:r}});A.add(d.world,i),t.circles.push({body:i,createdAt:Date.now(),initialRadius:n,currentRadius:n,color:r})}function Z(e,n){const c=e.body.position,o=n.body.position,r=o.x-c.x,i=o.y-c.y;return Math.sqrt(r*r+i*i)<=e.currentRadius+n.currentRadius+5}function X(e,n){let c;n===null?c=t.circles:n===void 0?c=t.circles.filter(i=>i.color===e.color):c=t.circles.filter(i=>i.color===n);const o=new Set([e]),r=[e];for(;r.length>0;){const i=r.pop();c.forEach(s=>{!o.has(s)&&Z(i,s)&&(o.add(s),r.push(s))})}return Array.from(o)}function J(e){return X(e,null)}function Q(){if(t.circles.length===0)return null;let e=null,n=-1/0;if(t.circles.forEach(i=>{i.body.position.y>n&&(n=i.body.position.y,e=i)}),!e)return null;const c=J(e);if(c.length===0)return null;let o=1/0;return c.forEach(i=>{i.body.position.y<o&&(o=i.body.position.y)}),o/l.height*100}function C(e){const n={x:e.body.position.x,y:e.body.position.y},c=X(e);c.length>t.maxChain&&(t.maxChain=c.length),c.forEach(o=>{const r=o.body.position;for(let i=0;i<33;i++){const s=Math.PI*2*i/33,a=(5+Math.random()*10)/3,f=r.x+Math.cos(s)*o.currentRadius,h=r.y+Math.sin(s)*o.currentRadius,x=2,u=_.circle(f,h,x,{restitution:.3,friction:.05,render:{fillStyle:o.color}});U.setVelocity(u,{x:Math.cos(s)*a,y:Math.sin(s)*a}),A.add(d.world,u),t.particles.push({body:u,createdAt:Date.now(),initialRadius:x})}A.remove(d.world,o.body)}),c.forEach(o=>{const r=t.circles.indexOf(o);r>-1&&t.circles.splice(r,1)}),W(n.x,n.y)}function ee(){l.addEventListener("click",e=>{if(t.isGameOver){Date.now()-t.gameOverStartTime>=v&&P();return}const n=l.getBoundingClientRect(),c=e.clientX-n.left,o=e.clientY-n.top;for(let r=t.circles.length-1;r>=0;r--){const i=t.circles[r],s=i.body.position.x-c,a=i.body.position.y-o;if(Math.sqrt(s*s+a*a)<=i.currentRadius){C(i);break}}}),window.addEventListener("keydown",e=>{if(t.isGameOver){Date.now()-t.gameOverStartTime>=v&&(e.preventDefault(),P());return}switch(e.key){case"ArrowUp":e.preventDefault(),g("up");break;case"ArrowDown":e.preventDefault(),g("down");break;case"ArrowLeft":e.preventDefault(),g("left");break;case"ArrowRight":e.preventDefault(),g("right");break;case"Enter":e.preventDefault(),t.selectedCircleIndex>=0&&t.selectedCircleIndex<t.circles.length&&C(t.circles[t.selectedCircleIndex]);break;case" ":e.preventDefault(),t.selectedCircleIndex===-1?I():t.selectedCircleIndex>=0&&t.selectedCircleIndex<t.circles.length&&C(t.circles[t.selectedCircleIndex]);break}})}function te(){const e=y.context;e.save(),e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(0,0,l.width,l.height),e.textAlign="center",e.textBaseline="middle",t.isNewHighScore&&(e.font="bold 48px Arial",e.fillStyle="#FFD700",e.fillText("ðŸ‘‘ New high score!",l.width/2,l.height/2-150)),e.font="bold 96px Arial",e.fillStyle="#ffffff",e.fillText("GAME OVER",l.width/2,l.height/2-50),e.font="bold 40px Arial",e.fillStyle="#ffffff",e.fillText(`Max chain: ${t.maxChain}`,l.width/2,l.height/2+30),e.font="bold 32px Arial",e.fillStyle="#aaaaaa",e.fillText(`High score: ${t.highScore}`,l.width/2,l.height/2+80),Date.now()-t.gameOverStartTime>=v&&(e.font="bold 32px Arial",e.fillStyle="#ffffff",e.fillText("Click to restart",l.width/2,l.height/2+150)),e.textAlign="center";const c=l.width-200;e.font="bold 32px Arial",e.fillStyle="#ffffff",e.textBaseline="top",e.fillText("MAX",c,40),e.font="bold 32px Arial",e.fillStyle="#ffffff",e.fillText("CHAIN",c,80),e.font="bold 96px Arial",e.fillStyle="#ffffff",e.fillText(`${t.maxChain}`,c,120),e.restore()}function ne(){if(t.selectedCircleIndex>=0&&t.selectedCircleIndex<t.circles.length){const e=t.circles[t.selectedCircleIndex],n=y.context,c=e.body.position,o=e.currentRadius+15;n.beginPath(),n.arc(c.x,c.y,o,0,Math.PI*2),n.strokeStyle="#ffffff",n.lineWidth=5,n.stroke()}}function ie(){const e=y.context;e.save(),e.textAlign="center";const n=l.width-200;e.font="bold 32px Arial",e.fillStyle="#ffffff",e.textBaseline="top",e.fillText("MAX",n,40),e.font="bold 32px Arial",e.fillStyle="#ffffff",e.fillText("CHAIN",n,80),e.font="bold 96px Arial",e.fillStyle="#ffffff",e.fillText(`${t.maxChain}`,n,120),e.restore()}const{World:re,Body:oe}=Matter;function O(){const e=Date.now();if(t.isGameOver){te(),requestAnimationFrame(O);return}const n=Q();n!==null&&n<0&&K(),n!==null&&n<=q?document.body.classList.add("danger-zone"):document.body.classList.remove("danger-zone"),t.selectedCircleIndex>=t.circles.length&&(t.selectedCircleIndex=-1);const c=[];t.particles.forEach(o=>{const i=(e-o.createdAt)/1e3;if(i>=1)c.push(o);else{const s=1-i;o.body.render.opacity=s;const a=1-i*.9,h=o.initialRadius*a/(o.body.circleRadius||o.initialRadius);h>.01&&oe.scale(o.body,h,h)}}),c.forEach(o=>{re.remove(d.world,o.body);const r=t.particles.indexOf(o);r>-1&&t.particles.splice(r,1)}),ne(),ie(),requestAnimationFrame(O)}function $(){setTimeout(()=>{t.isGameOver||(j(),t.spawnInterval=Math.max(50,t.spawnInterval-Y)),$()},t.spawnInterval)}B(window.innerWidth,window.innerHeight);window.addEventListener("resize",F);ee();O();$();</script>
  <style rel="stylesheet" crossorigin>*{margin:0;padding:0;box-sizing:border-box}body{width:100vw;height:100vh;background-color:#000;overflow:hidden;position:relative}body.danger-zone{animation:pulseRed 2s ease-in-out infinite}@keyframes pulseRed{0%{background-color:#000}50%{background-color:red}to{background-color:#000}}#canvas{display:block;width:100%;height:100%}</style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <script src="https://cdn.jsdelivr.net/npm/matter-js@0.19.0/build/matter.min.js"></script>
</body>
</html>
